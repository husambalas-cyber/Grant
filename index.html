<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ูุธุงู ุชุนุจุฆุฉ ูุชุญููู ุงูููุญุฉ</title>

<style>
body{font-family:Arial;background:#f2f2f2;padding:20px}
.box{background:#fff;padding:20px;border-radius:8px;max-width:1150px;margin:auto}
input,button{padding:6px;margin:5px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #999;padding:6px;text-align:center}
.summary{background:#e8f0ff;padding:10px;border-radius:6px;margin-top:10px;font-weight:bold}
.error{color:red;font-weight:bold}
</style>
</head>

<body>

<div class="box">

<h2>ูุธุงู ุชุนุจุฆุฉ ูุชุญููู ุงูููุญุฉ</h2>

<!-- ============================= -->
<!--        ุจูุงูุงุช ุงูุฑุฃุณ          -->
<!-- ============================= -->

<label>ุงููุฏูุฑูุฉ:</label>
<input id="directorate">

<label>ุงููุฏุฑุณุฉ:</label>
<input id="school">

<label>ุงูุฑุตูุฏ ุงููุฏูุฑ:</label>
<input id="rolled" type="number">

<label>ุงูููุญุฉ ุงูุญุงููุฉ:</label>
<input id="grant" type="number">

<br>
<button onclick="calculateBalance()">ุญุณุงุจ ุงูุฑุตูุฏ</button>

<div class="summary">
ุงูุฑุตูุฏ ุงูุญุงูู: <span id="currentBalance">0</span>
</div>

<hr>

<!-- ============================= -->
<!--     ูุณุจ ุงูุตุฑู (C10โG10)      -->
<!-- ============================= -->

<h3>ูุณุจ ุงูุตุฑู ุงูุฑุฆูุณูุฉ (ูุฌุจ ุฃู ูููู ูุฌููุนูุง = 100%)</h3>

<table>
<tr>
<th>ูุฌุชูุนุงุช ุงูุชุนูู</th>
<th>ุงูุตูุงูุฉ</th>
<th>ุงูุดุฑุงูุฉ</th>
<th>ููุงุฒู ุงูุชุนูู</th>
<th>ุชุดุฌูุน ุงูุชููุฒ</th>
</tr>

<tr>
<td><input id="p1" type="number"> %</td>
<td><input id="p2" type="number"> %</td>
<td><input id="p3" type="number"> %</td>
<td><input id="p4" type="number"> %</td>
<td><input id="p5" type="number"> %</td>
</tr>
</table>

<div id="percentWarning" class="error"></div>

<hr>

<!-- ============================= -->
<!--        ุฅุถุงูุฉ ูุงุชูุฑุฉ          -->
<!-- ============================= -->

<h3>ุฅุถุงูุฉ ูุงุชูุฑุฉ ุฌุฏูุฏุฉ</h3>

ุฑูู ุงููุงุชูุฑุฉ <input id="invoiceNo">
ุงูุชุงุฑูุฎ <input id="invoiceDate" type="date">
ูุจูุบ ุงููุงุชูุฑุฉ <input id="invoiceAmount" type="number">

<br><br>

<table>
<tr>
<th>ูุฌุชูุนุงุช ุงูุชุนูู</th>
<th>ุงูุตูุงูุฉ</th>
<th>ุงูุดุฑุงูุฉ</th>
<th>ููุงุฒู ุงูุชุนูู</th>
<th>ุชุดุฌูุน ุงูุชููุฒ</th>
</tr>
<tr>
<td><input id="c1"></td>
<td><input id="c2"></td>
<td><input id="c3"></td>
<td><input id="c4"></td>
<td><input id="c5"></td>
</tr>
</table>

<div class="summary">
ูุฌููุน ุงูุชูุฒูุน = <span id="sumDist">0</span>
</div>

<div id="limitWarning" class="error"></div>

<br>
<button onclick="addInvoice()">ุฅุถุงูุฉ ุงููุงุชูุฑุฉ</button>

<hr>

<!-- ============================= -->
<!--       ุฌุฏูู ุงูููุงุชูุฑ          -->
<!-- ============================= -->

<h3>ุงูููุงุชูุฑ ุงูููุถุงูุฉ</h3>

<table id="invoiceTable">
<thead>
<tr>
<th>ุฑูู</th>
<th>ุชุงุฑูุฎ</th>
<th>ูุฌุชูุนุงุช ุงูุชุนูู</th>
<th>ุงูุตูุงูุฉ</th>
<th>ุงูุดุฑุงูุฉ</th>
<th>ููุงุฒู ุงูุชุนูู</th>
<th>ุชุดุฌูุน ุงูุชููุฒ</th>
</tr>
</thead>
<tbody></tbody>
</table>

<hr>

<!-- ============================= -->
<!--   ุฃุฒุฑุงุฑ ุงูุชุญูู ูู Excel      -->
<!-- ============================= -->

<button onclick="testOpenExcel()">๐ ุงุฎุชุจุงุฑ ูุชุญ ููู Excel</button>
<button onclick="updateExcel()">ุชุญุฏูุซ ููู Excel ุงูุฃุตูู</button>

</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="app.js"></script>

</body>
</html>
